{"class":"org.apache.spark.ml.feature.SQLTransformer","timestamp":1581713749178,"sparkVersion":"2.3.3","uid":"dplyr_transformer_4028eea6dd1","paramMap":{"statement":"SELECT `cluster`, `pickup_year`, `pickup_mon`, `pickup_wday`, `pickup_nday`, `pickup_hour`, `rides`, `passengers`, `distance`, `fare`, `tip`, `passengers` / `rides` AS `ppr`, `distance` / `rides` AS `dpr`, `fare` / `rides` AS `fpr`, `tip` / `rides` AS `tpr`, `fare` / `distance` AS `fpm`, `tip` / `distance` AS `tpm`\nFROM (SELECT `cluster`, `pickup_year`, `pickup_mon`, `pickup_wday`, `pickup_nday`, `pickup_hour`, count(*) AS `rides`, SUM(`passenger_count`) AS `passengers`, SUM(`trip_distance`) AS `distance`, SUM(`fare_amt`) AS `fare`, SUM(`tip_amt`) AS `tip`\nFROM (SELECT `cluster`, `start_lon`, `start_lat`, `passenger_count`, `trip_time`, `trip_distance`, `payment_type`, `fare_amt`, `tip_amt`, date_format(`trip_pickup_datetime`, \"YYYY-MM-DD\") AS `pickup_date`, date_format(`trip_pickup_datetime`, \"YYYY\") AS `pickup_year`, date_format(`trip_pickup_datetime`, \"MM\") AS `pickup_mon`, date_format(`trip_pickup_datetime`, \"DD\") AS `pickup_day`, hour(`trip_pickup_datetime`) AS `pickup_hour`, date_format(`trip_pickup_datetime`, \"E\") AS `pickup_wday`, dayofweek(`trip_pickup_datetime`) AS `pickup_nday`\nFROM (SELECT `vendor_name`, to_utc_timestamp(`trip_pickup_datetime`, \"UTC\") AS `trip_pickup_datetime`, `trip_dropoff_datetime`, `passenger_count`, `trip_distance`, `start_lon`, `start_lat`, `rate_code`, `store_and_forward`, `end_lon`, `end_lat`, `payment_type`, `fare_amt`, `surcharge`, `mta_tax`, `tip_amt`, `tolls_amt`, `total_amt`, `features`, `cluster`, `trip_time`\nFROM (SELECT `vendor_name`, `trip_pickup_datetime`, `trip_dropoff_datetime`, `passenger_count`, `trip_distance`, `start_lon`, `start_lat`, `rate_code`, `store_and_forward`, `end_lon`, `end_lat`, `payment_type`, `fare_amt`, `surcharge`, `mta_tax`, `tip_amt`, `tolls_amt`, `total_amt`, `features`, `cluster`, unix_timestamp(`trip_dropoff_datetime`) - unix_timestamp(`trip_pickup_datetime`) AS `trip_time`\nFROM (SELECT `vendor_name`, `trip_pickup_datetime`, `trip_dropoff_datetime`, `passenger_count`, `trip_distance`, `start_lon`, `start_lat`, `rate_code`, `store_and_forward`, `end_lon`, `end_lat`, LOWER(`payment_type`) AS `payment_type`, `fare_amt`, `surcharge`, `mta_tax`, `tip_amt`, `tolls_amt`, `total_amt`, `features`, `cluster`\nFROM `__THIS__`) `dbplyr_012`) `dbplyr_013`) `dbplyr_014`) `dbplyr_015`\nGROUP BY `cluster`, `pickup_year`, `pickup_mon`, `pickup_wday`, `pickup_nday`, `pickup_hour`) `dbplyr_016`\nORDER BY `cluster`"}}
