{"class":"org.apache.spark.ml.feature.SQLTransformer","timestamp":1581518626379,"sparkVersion":"2.3.3","uid":"dplyr_transformer_7783c0551b","paramMap":{"statement":"SELECT `start_lon`, `start_lat`, `passenger_count`, `trip_time`, `trip_distance`, `payment_type`, `fare_amt`, `tip_amt`, date_format(`trip_pickup_datetime`, \"YYYY-MM-DD\") AS `pickup_date`, date_format(`trip_pickup_datetime`, \"YYYY\") AS `pickup_year`, date_format(`trip_pickup_datetime`, \"MM\") AS `pickup_mon`, date_format(`trip_pickup_datetime`, \"DD\") AS `pickup_day`, hour(`trip_pickup_datetime`) AS `pickup_hour`, date_format(`trip_pickup_datetime`, \"E\") AS `pickup_wday`, dayofweek(`trip_pickup_datetime`) AS `pickup_nday`\nFROM (SELECT `vendor_name`, to_utc_timestamp(`trip_pickup_datetime`, \"UTC\") AS `trip_pickup_datetime`, `trip_dropoff_datetime`, `passenger_count`, `trip_distance`, `start_lon`, `start_lat`, `rate_code`, `store_and_forward`, `end_lon`, `end_lat`, `payment_type`, `fare_amt`, `surcharge`, `mta_tax`, `tip_amt`, `tolls_amt`, `total_amt`, `trip_time`\nFROM (SELECT `vendor_name`, `trip_pickup_datetime`, `trip_dropoff_datetime`, `passenger_count`, `trip_distance`, `start_lon`, `start_lat`, `rate_code`, `store_and_forward`, `end_lon`, `end_lat`, `payment_type`, `fare_amt`, `surcharge`, `mta_tax`, `tip_amt`, `tolls_amt`, `total_amt`, unix_timestamp(`trip_dropoff_datetime`) - unix_timestamp(`trip_pickup_datetime`) AS `trip_time`\nFROM (SELECT *\nFROM (SELECT `vendor_name`, `trip_pickup_datetime`, `trip_dropoff_datetime`, `passenger_count`, `trip_distance`, `start_lon`, `start_lat`, `rate_code`, `store_and_forward`, `end_lon`, `end_lat`, LOWER(`payment_type`) AS `payment_type`, `fare_amt`, `surcharge`, `mta_tax`, `tip_amt`, `tolls_amt`, `total_amt`\nFROM (SELECT `vendor_name`, `Trip_Pickup_DateTime` AS `trip_pickup_datetime`, `Trip_Dropoff_DateTime` AS `trip_dropoff_datetime`, `Passenger_Count` AS `passenger_count`, `Trip_Distance` AS `trip_distance`, `Start_Lon` AS `start_lon`, `Start_Lat` AS `start_lat`, `Rate_Code` AS `rate_code`, `store_and_forward`, `End_Lon` AS `end_lon`, `End_Lat` AS `end_lat`, `Payment_Type` AS `payment_type`, `Fare_Amt` AS `fare_amt`, `surcharge`, `mta_tax`, `Tip_Amt` AS `tip_amt`, `Tolls_Amt` AS `tolls_amt`, `Total_Amt` AS `total_amt`\nFROM `__THIS__`) `dbplyr_001`) `dbplyr_002`\nWHERE ((`start_lon` > -74.05) AND (`start_lon` < -73.75) AND (`start_lat` > 40.58) AND (`start_lat` < 40.9) AND (`end_lon` > -74.05) AND (`end_lon` < -73.75) AND (`end_lat` > 40.58) AND (`end_lat` < 40.9) AND (`passenger_count` > 0.0) AND (`passenger_count` < 7.0) AND (`trip_distance` > 0.0) AND (`trip_distance` < 100.0) AND (`total_amt` > 0.0) AND (NOT(((`trip_pickup_datetime`) IS NULL))))) `dbplyr_003`) `dbplyr_004`) `dbplyr_005`"}}
